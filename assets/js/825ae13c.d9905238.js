"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9658],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=o.createContext({}),s=function(e){var t=o.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return o.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,u=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,f=d["".concat(u,".").concat(m)]||d[m]||p[m]||a;return n?o.createElement(f,i(i({ref:t},c),{},{components:n})):o.createElement(f,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4284:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return u},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return p}});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),i=["components"],l={id:"tpm2",title:"How to set up automatic TPM2 unlocking and secure your GRUB (bootloader)?",sidebar_label:"TPM2 unlocking & Secure GRUB"},u=void 0,s={unversionedId:"tpm2",id:"tpm2",title:"How to set up automatic TPM2 unlocking and secure your GRUB (bootloader)?",description:"In order to automatically unlock the encrypted root partition, you need to set up TPM2 unlocking during boot. Additionally, you will secure your GRUB (bootloader) with a password.",source:"@site/docs/tpm2.md",sourceDirName:".",slug:"/tpm2",permalink:"/Nextcloud-NAS-Guide/docs/tpm2",draft:!1,editUrl:"https://github.com/szaimen/Nextcloud-NAS-Guide/edit/main/docs/tpm2.md",tags:[],version:"current",frontMatter:{id:"tpm2",title:"How to set up automatic TPM2 unlocking and secure your GRUB (bootloader)?",sidebar_label:"TPM2 unlocking & Secure GRUB"},sidebar:"docs",previous:{title:"SSH",permalink:"/Nextcloud-NAS-Guide/docs/ssh"},next:{title:"Install Nextcloud",permalink:"/Nextcloud-NAS-Guide/docs/install-nextcloud"}},c={},p=[],d={toc:p};function m(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In order to automatically unlock the encrypted root partition, you need to set up TPM2 unlocking during boot. Additionally, you will secure your GRUB (bootloader) with a password."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The abbreviation ",(0,a.kt)("inlineCode",{parentName:"p"},"CLI")," will be used from now on in this guide (as synonym for controlling your server over SSH) and stands for ",(0,a.kt)("inlineCode",{parentName:"p"},"Command Line Interface"),".")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Connect from a PC in the same network to your server over SSH (if not already done)"),(0,a.kt)("li",{parentName:"ol"},"Copy and paste the following command over ",(0,a.kt)("inlineCode",{parentName:"li"},"CLI"),":",(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"wget https://raw.githubusercontent.com/nextcloud/vm/main/not-supported/tpm2-unlock.sh \\\n&& sudo bash tpm2-unlock.sh\n")),"(",(0,a.kt)("strong",{parentName:"li"},"Hint"),": On Windows 10, pasting works by pressing the right mouse-key)"),(0,a.kt)("li",{parentName:"ol"},"Enter your ",(0,a.kt)("strong",{parentName:"li"},"password")," again"),(0,a.kt)("li",{parentName:"ol"},"Choose to install TPM2 Unlock"),(0,a.kt)("li",{parentName:"ol"},"Wait until it has configured some small things"),(0,a.kt)("li",{parentName:"ol"},"Type in your ",(0,a.kt)("strong",{parentName:"li"},"LUKS password")," for your root partition"),(0,a.kt)("li",{parentName:"ol"},"Wait a while until it shows the next popup"),(0,a.kt)("li",{parentName:"ol"},"Now enter a ",(0,a.kt)("strong",{parentName:"li"},"new password")," for GRUB (bootloader) and store it at a safe place.",(0,a.kt)("br",null),"\n(The password should be random, at least 8 characters long and no special characters needed)"),(0,a.kt)("li",{parentName:"ol"},"Wait until it shows that the setup was successfull and press ",(0,a.kt)("inlineCode",{parentName:"li"},"[ENTER]")," to reboot your server")),(0,a.kt)("p",null,"Now it should unlock the root partition during boot automatically (so that you don't have to enter the LUKS passphrase). If not, something has failed."),(0,a.kt)("admonition",{title:"Please note! ",type:"caution"},(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("strong",{parentName:"p"},"It is not recommended to proceed with this guide, if it doesn't unlock the root partition automatically at this point!"),(0,a.kt)("br",null),"\n(This is the case, if it asks you after the reboot for the Ubuntu login credentials and not for the LUKS password.)")))}m.isMDXComponent=!0}}]);